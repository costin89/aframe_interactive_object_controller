<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A-Frame Scene with Object Orbit Component</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script>
    AFRAME.registerComponent('cursor-drag-rotate', {
      schema: {
        speed: {type: 'number', default: 1}, // Geschwindigkeit der Drehung
        zoomSpeed: {type: 'number', default: 0.1}, // Geschwindigkeit des Zooms
        minScale: {type: 'number', default: 1.0}, // Minimale Skalierung
        maxScale: {type: 'number', default: 2.0} // Maximale Skalierung
      },
      init: function() {
        this.isMouseDown = false;
        this.isMouseOver = false;
        this.startX = 0;
        this.startY = 0;
        this.lastClickTime = 0;
        const el = this.el;
        const data = this.data;
        
        el.addEventListener('mouseenter', () => this.isMouseOver = true);
        el.addEventListener('mouseleave', () => this.isMouseOver = false);
        
        window.addEventListener('mousedown', (event) => {
          if (this.isMouseOver) {
            this.isMouseDown = true;
            this.startX = event.clientX;
            this.startY = event.clientY;
          }
        });
        
        window.addEventListener('mousemove', (event) => {
          if (this.isMouseDown && this.isMouseOver) {
            let diffX = event.clientX - this.startX;
            let diffY = event.clientY - this.startY;
            this.startX = event.clientX;
            this.startY = event.clientY;
            
            let rotation = el.getAttribute('rotation');
            rotation.y += diffX * data.speed;
            rotation.x -= diffY * data.speed;
            el.setAttribute('rotation', rotation);
          }
        });
        
        window.addEventListener('mouseup', () => this.isMouseDown = false);
        
        el.addEventListener('click', () => {
          const currentTime = new Date().getTime();
          if (currentTime - this.lastClickTime < 500) {
            el.setAttribute('rotation', {x: 0, y: 0, z: 0});
            el.setAttribute('scale', {x: 1.0, y: 1.0, z: 1.0});
          }
          this.lastClickTime = currentTime;
        });
        
        window.addEventListener('wheel', (event) => {
          if (this.isMouseOver) {
            let scale = el.getAttribute('scale');
            let zoomFactor = event.deltaY * -data.zoomSpeed;
            scale.x = Math.max(data.minScale, Math.min(data.maxScale, scale.x + zoomFactor));
            scale.y = Math.max(data.minScale, Math.min(data.maxScale, scale.y + zoomFactor));
            scale.z = Math.max(data.minScale, Math.min(data.maxScale, scale.z + zoomFactor));
            el.setAttribute('scale', scale);
          }
        });

        // Touch-Events nur auf MobilgerÃ¤ten aktivieren
        if (AFRAME.utils.device.isMobile()) {
          window.addEventListener('touchstart', (event) => {
            if (this.isMouseOver) {
              this.isMouseDown = true;
              this.startX = event.touches[0].clientX;
              this.startY = event.touches[0].clientY;
            }
          }, {passive: true});
          
          window.addEventListener('touchmove', (event) => {
            if (this.isMouseDown && this.isMouseOver) {
              let diffX = event.touches[0].clientX - this.startX;
              let diffY = event.touches[0].clientY - this.startY;
              this.startX = event.touches[0].clientX;
              this.startY = event.touches[0].clientY;
              
              let rotation = el.getAttribute('rotation');
              rotation.y += diffX * data.speed;
              rotation.x -= diffY * data.speed;
              el.setAttribute('rotation', rotation);
            }
          }, {passive: true});
          
          window.addEventListener('touchend', () => this.isMouseDown = false);
        }
      }
    });
  </script>
</head>
<body>
    <a-scene xr-mode-ui="enabled: false">
      <a-box position="0 1.5 -5" rotation="0 0 0" color="#4CC3D9" cursor-drag-rotate="speed: 0.1; zoomSpeed: 0.05; minScale: 1.0; maxScale: 2.0"></a-box>
        <a-entity camera look-controls="false" cursor-visible="false" position="0 1.6 0">
          <a-cursor id="cursor" color="red" fuse="true" visible="false"></a-cursor>
        </a-entity>
    </a-scene>
</body>
</html>
